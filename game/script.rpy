# Фон — фотография
image bg street = "images/bg/street.jpg"
image bg room 1 = "images/bg/room1.jpg"
image bg room 2 = "images/bg/room2.jpg"
image bg room 3 = "images/bg/room3.jpg"
image bg room 4 = "images/bg/room4.jpg"
image bg corridor = "images/bg/corridor.jpg"
image bg corridor2 = "images/bg/corridor2.jpg"
image bg window_macbook = "images/bg/window_macbook.png"
image bg robot_room = "images/bg/robot_room.png"
image bg capybara = "images/bg/full_valshtein.webp"

# Объекты  
image robot items idle = "images/objects/robot_items_idle.png"
image robot items hover = "images/objects/robot_items_hover.png"

# Спрайты
image gg day 1 neutral = At("images/characters/gg_day1/nuetral.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 scared = At("images/characters/gg_day1/scared.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 questioning = At("images/characters/gg_day1/questioning.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 happy2 = At("images/characters/gg_day1/happy2.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 happy = At("images/characters/gg_day1/happy.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 furious = At("images/characters/gg_day1/furious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 DGAF = At("images/characters/gg_day1/DGAF.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 curious = At("images/characters/gg_day1/curious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 calm = At("images/characters/gg_day1/calm.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 angry = At("images/characters/gg_day1/angry.png", Transform(zoom=1.3, xzoom=-1))

image nerd neutral = At("images/characters/nerd/neutral.png", Transform(zoom=1.3))
image nerd angry = At("images/characters/nerd/angry.png", Transform(zoom=1.3))
image nerd calm = At("images/characters/nerd/calm.png", Transform(zoom=1.3))
image nerd curious = At("images/characters/nerd/curious.png", Transform(zoom=1.3))
image nerd DGAF = At("images/characters/nerd/DGAF.png", Transform(zoom=1.3))
image nerd furious = At("images/characters/nerd/furious.png", Transform(zoom=1.3))
image nerd happy = At("images/characters/nerd/happy.png", Transform(zoom=1.3))
image nerd happy2 = At("images/characters/nerd/happy2.png", Transform(zoom=1.3))
image nerd questioning = At("images/characters/nerd/questioning.png", Transform(zoom=1.3))
image nerd scared = At("images/characters/nerd/scared.png", Transform(zoom=1.3))

image wallstein angry = At("images/characters/wallstein/angry.png", Transform(zoom=1.3))
image wallstein happy = At("images/characters/wallstein/happy.png", Transform(zoom=1.3))
image wallstein neutral = At("images/characters/wallstein/neutral.png", Transform(zoom=1.3))
image wallstein questioning = At("images/characters/wallstein/questioning.png", Transform(zoom=1.3))
image wallstein thinking = At("images/characters/wallstein/thinking.png", Transform(zoom=1.3))

image lestenko angry = At("images/characters/lestenko/angry.png", Transform(zoom=1.3))
image lestenko neutral = At("images/characters/lestenko/neutral.png", Transform(zoom=1.3))
image lestenko happy = At("images/characters/lestenko/happy.png", Transform(zoom=1.3))
image lestenko questioning = At("images/characters/lestenko/questioning.png", Transform(zoom=1.3))
image lestenko notUnderstanding = At("images/characters/lestenko/notUnderstanding.png", Transform(zoom=1.3))

image rakova angry = At("images/characters/rakova/angry.png", Transform(zoom=1.3))
image rakova happy = At("images/characters/rakova/happy.png", Transform(zoom=1.3))
image rakova thinking = At("images/characters/rakova/thinking.png", Transform(zoom=1.3))
image rakova neutral = At("images/characters/rakova/neutral.png", Transform(zoom=1.3))
image rakova questioning = At("images/characters/rakova/questioning.png", Transform(zoom=1.3))

image tarasov angry = At("images/characters/tarasov/angry.png", Transform(zoom=1.3))
image tarasov happy = At("images/characters/tarasov/happy.png", Transform(zoom=1.3))
image tarasov thinking = At("images/characters/tarasov/thinking.png", Transform(zoom=1.3))
image tarasov neutral = At("images/characters/tarasov/neutral.png", Transform(zoom=1.3))
image tarasov questioning = At("images/characters/tarasov/questioning.png", Transform(zoom=1.3))

image semyonova angry = At("images/characters/semyonova/angry.png", Transform(zoom=1.3))
image semyonova happy = At("images/characters/semyonova/happy.png", Transform(zoom=1.3))
image semyonova thinking = At("images/characters/semyonova/thinking.png", Transform(zoom=1.3))
image semyonova neutral = At("images/characters/semyonova/neutral.png", Transform(zoom=1.3))
image semyonova questioning = At("images/characters/semyonova/questioning.png", Transform(zoom=1.3))

image zharova angry = At("images/characters/zharova/angry.png", Transform(zoom=1.3))
image zharova happy = At("images/characters/zharova/happy.png", Transform(zoom=1.3))
image zharova thinking = At("images/characters/zharova/thinking.png", Transform(zoom=1.3))
image zharova neutral = At("images/characters/zharova/neutral.png", Transform(zoom=1.3))
image zharova questioning = At("images/characters/zharova/questioning.png", Transform(zoom=1.3))

image naurusova angry = At("images/characters/naurusova/angry.png", Transform(zoom=1.3))
image naurusova happy = At("images/characters/naurusova/happy.png", Transform(zoom=1.3))
image naurusova thinking = At("images/characters/naurusova/thinking.png", Transform(zoom=1.3))
image naurusova neutral = At("images/characters/naurusova/neutral.png", Transform(zoom=1.3))
image naurusova questioning = At("images/characters/naurusova/questioning.png", Transform(zoom=1.3))

image scherbakova angry = At("images/characters/scherbakova/angry.png", Transform(zoom=1.3))
image scherbakova happy = At("images/characters/scherbakova/happy.png", Transform(zoom=1.3))
image scherbakova thinking = At("images/characters/scherbakova/thinking.png", Transform(zoom=1.3))
image scherbakova neutral = At("images/characters/scherbakova/neutral.png", Transform(zoom=1.3))
image scherbakova questioning = At("images/characters/scherbakova/questioning.png", Transform(zoom=1.3))

image logunova angry = At("images/characters/logunova/angry.png", Transform(zoom=1.3))
image logunova happy = At("images/characters/logunova/happy.png", Transform(zoom=1.3))
image logunova thinking = At("images/characters/logunova/thinking.png", Transform(zoom=1.3))
image logunova neutral = At("images/characters/logunova/neutral.png", Transform(zoom=1.3))
image logunova questioning = At("images/characters/logunova/questioning.png", Transform(zoom=1.3))

image bully neutral = At("images/characters/bully/nuetral.png", Transform(zoom=1.3))
image bully scared = At("images/characters/bully/scared.png", Transform(zoom=1.3))
image bully questioning = At("images/characters/bully/questioning.png", Transform(zoom=1.3))
image bully questioning2 = At("images/characters/bully/questioning2.png", Transform(zoom=1.3))
image bully happy = At("images/characters/bully/happy.png", Transform(zoom=1.3))
image bully happy2 = At("images/characters/bully/happy2.png", Transform(zoom=1.3))
image bully furious = At("images/characters/bully/furious.png", Transform(zoom=1.3))
image bully curious = At("images/characters/bully/curious.png", Transform(zoom=1.3))
image bully angry = At("images/characters/bully/angry.png", Transform(zoom=1.3))
image bully talking = At("images/characters/bully/talking.png", Transform(zoom=1.3))

image gg day 2 angry = At("images/characters/gg_day2/angry.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 calm = At("images/characters/gg_day2/calm.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 curious = At("images/characters/gg_day2/curious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 furious = At("images/characters/gg_day2/furious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 happy = At("images/characters/gg_day2/happy.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 happy2 = At("images/characters/gg_day2/happy2.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 happy3 = At("images/characters/gg_day2/happy3.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 neutral = At("images/characters/gg_day2/neutral.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 questioning = At("images/characters/gg_day2/questioning.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 questioning2 = At("images/characters/gg_day2/questioning2.png", Transform(zoom=1.3, xzoom=-1))

image gg day 3 angry = At("images/characters/gg_day3/angry.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 calm = At("images/characters/gg_day3/calm.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 curious = At("images/characters/gg_day3/curious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 DGAF = At("images/characters/gg_day3/DGAF.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 furious = At("images/characters/gg_day3/furious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 happy = At("images/characters/gg_day3/happy.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 happy2 = At("images/characters/gg_day3/happy2.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 neutral = At("images/characters/gg_day3/neutral.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 questioning = At("images/characters/gg_day3/questioning.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 scared = At("images/characters/gg_day3/scared.png", Transform(zoom=1.3, xzoom=-1))

image altushka angry = At("images/characters/altushka/angry.png", Transform(zoom=1.3))
image altushka blush = At("images/characters/altushka/blush.png", Transform(zoom=1.3))
image altushka curious = At("images/characters/altushka/curious.png", Transform(zoom=1.3))
image altushka DGAF = At("images/characters/altushka/DGAF.png", Transform(zoom=1.3))
image altushka DGAF2 = At("images/characters/altushka/DGAF2.png", Transform(zoom=1.3))
image altushka furious = At("images/characters/altushka/furious.png", Transform(zoom=1.3))
image altushka happy = At("images/characters/altushka/happy.png", Transform(zoom=1.3))
image altushka happy2 = At("images/characters/altushka/happy2.png", Transform(zoom=1.3))
image altushka irritated = At("images/characters/altushka/irritated.png", Transform(zoom=1.3))
image altushka neutral = At("images/characters/altushka/neutral.png", Transform(zoom=1.3))
image altushka scared = At("images/characters/altushka/scared.png", Transform(zoom=1.3))

image robot angry = At("images/characters/robot/angry.png", Transform(zoom=1.3))
image robot full_ready = At("images/characters/robot/full_ready.png", Transform(zoom=1.3))
image robot items = At("images/characters/robot/items.png", Transform(zoom=1.3))
image robot pre_ready = At("images/characters/robot/pre_ready.png", Transform(zoom=1.3))
image robot prototype = At("images/characters/robot/prototype.png", Transform(zoom=1.3))
image robot working = At("images/characters/robot/working.png", Transform(zoom=1.3))

image matveev angry = At("images/characters/matveev/angry.png", Transform(zoom=1.3))
image matveev happy = At("images/characters/matveev/happy.png", Transform(zoom=1.3))
image matveev thinking = At("images/characters/matveev/thinking.png", Transform(zoom=1.3))
image matveev neutral = At("images/characters/matveev/neutral.png", Transform(zoom=1.3))
image matveev questioning = At("images/characters/matveev/questioning.png", Transform(zoom=1.3))

image kurochkin angry = At("images/characters/kurochkin/angry.png", Transform(zoom=1.3))
image kurochkin happy = At("images/characters/kurochkin/happy.png", Transform(zoom=1.3))
image kurochkin thinking = At("images/characters/kurochkin/thinking.png", Transform(zoom=1.3))
image kurochkin neutral = At("images/characters/kurochkin/neutral.png", Transform(zoom=1.3))
image kurochkin questioning = At("images/characters/kurochkin/questioning.png", Transform(zoom=1.3))
 
# Позиции
define left_pos = Position(xalign=-0.1, ypos=1.4)
define right_pos = Position(xalign=1.1, ypos=1.4)

# Стиль для текста диалога
style say_dialogue:
    color "#FFFFFF"
    size 50
    text_align 0  # Выравнивание по центру
    xalign 0      # По центру по горизонтали
    xpos 0.19
    yalign 0.5

# Стиль для имени персонажа
style say_label:
    color "#FFFFFF"
    size 50
    bold True

# ============================
#   РЕГИСТРАЦИЯ ПЕРСОНАЖЕЙ
# ============================

init python:
    # Словарь: кодовое имя → отображаемое имя
    CHARACTER_NAMES = {
        "gg_day1": "Герой",
        "gg_day2": "Герой",
        "gg_day3": "Герой",
        "nerd": "Ботаник",
        "bully": "Хулиган",
        "altushka": "Алтушка",
        "robot": "Робот",
        "wallstein": "Вальдштейн",
        "lestenko": "Лестенко",
        "rakova": "Ракова",
        "tarasov": "Тарасов",
        "semyonova": "Семёнова",
        "zharova": "Жарова",
        "naurusova": "Наурусова",
        "scherbakova": "Щербакова",
        "logunova": "Логунова",
        "matveev": "Матвеев",
        "kurochkin": "Курочкин",
    }

# Автоматически создаём объекты Ren'Py Character
init python:
    for code, name in CHARACTER_NAMES.items():
        renpy.store.__dict__[code] = Character(name)

# ============================
#   СИСТЕМА ЭМОЦИЙ
# ============================

init python:
    def _show_emote(prefix, emote, pos):
        img = f"{prefix} {emote}"

        if pos == "left":
            at_list = [left_pos]
        elif pos == "right":
            at_list = [right_pos]
        else:
            at_list = []

        renpy.show(img, at_list=at_list)

# Делаем ренпай-команды вида:
#     show_gg happy left
#     show_nerd angry right


init python:

    def make_show(prefix):
        def func(emote, pos="center"):
            _show_emote(prefix, emote, pos)
        return func

# Герой по дням
init python:
    show_gg = make_show("gg day 1")
    show_gg2 = make_show("gg day 2")
    show_gg3 = make_show("gg day 3")

# Остальные
init python:
    show_nerd = make_show("nerd")
    show_bully = make_show("bully")
    show_altushka = make_show("altushka")
    show_robot = make_show("robot")
    show_wallstein = make_show("wallstein")
    show_lestenko = make_show("lestenko")
    show_rakova = make_show("rakova")
    show_tarasov = make_show("tarasov")
    show_semyonova = make_show("semyonova")
    show_zharova = make_show("zharova")
    show_naurusova = make_show("naurusova")
    show_scherbakova = make_show("scherbakova")
    show_logunova = make_show("logunova")
    show_matveev = make_show("matveev")
    show_kurochkin = make_show("kurochkin")

transform fade_box:
    alpha 0.0
    linear 0.5 alpha 1.0  # плавное появление

transform fade_box_out:
    linear 0.5 alpha 0.0


label start:
    # Проигрываем видео 47 секунд
    play movie "images/video/intro.webm"
    # $ renpy.pause(47.0, hard=False)
    stop movie fadeout 1.0
    jump mathexam

screen center_box100(t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1850
        ysize 100

        xalign 0.5
        yalign 0.5

        padding (40, 40)

        text t :
            size 48
            color "#FFFFFF"
            text_align 0.5
            xalign 0.5

screen center_box150(t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1850
        ysize 150

        xalign 0.5
        yalign 0.5

        padding (40, 40)

        text t :
            size 48
            color "#FFFFFF"
            text_align 0.5
            xalign 0.5

screen center_box200(t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1850
        ysize 200

        xalign 0.5
        yalign 0.5

        padding (40, 40)

        text t :
            size 44
            color "#FFFFFF"
            text_align 0.5
            xalign 0.5

screen center_box250(t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1850
        ysize 250

        xalign 0.5
        yalign 0.5

        padding (40, 40)

        text t :
            size 44
            color "#FFFFFF"
            text_align 0.5
            xalign 0.5

screen center_box300(t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1850
        ysize 300

        xalign 0.5
        yalign 0.5

        padding (40, 40)

        text t :
            size 44
            color "#FFFFFF"
            text_align 0.5
            xalign 0.5

screen center_box350(t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1850
        ysize 350

        xalign 0.5
        yalign 0.5

        padding (40, 40)

        text t :
            size 44
            color "#FFFFFF"
            text_align 0.5
            xalign 0.5

screen center_box400(t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1850
        ysize 400

        xalign 0.5
        yalign 0.5

        padding (40, 40)

        text t :
            size 41
            color "#FFFFFF"
            text_align 0.5
            xalign 0.5

screen down_box(character_name=None, c="", t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1500
        ysize 300

        xalign 0.5
        ypos 1050  # чуть выше низа экрана, можно подправить
        yanchor 1.0

        padding (40, 40)

        vbox:
            spacing 10

            # Имя персонажа
            if character_name:
                text character_name:
                    size 40
                    color c  # золотой цвет, можно поменять
                    bold True
                    xalign 0.0  # слева внутри фрейма

            # Основной текст
            text t :
                size 35
                color "#FFFFFF"
                text_align 0.0
                xalign 0.0

label street:
    scene bg street with dissolve
    window hide

    show screen center_box250("Солнечный свет золотит тонкие пруты железного забора.\nДля кого-то это пространство между воротами и корпусом — просто\nдорога, но для него — портал в новую жизнь.") with dissolve

    $ renpy.pause(999.0)

    hide screen center_box250 with dissolve

    # jump corridor_talking
    jump room_talking2

label corridor_talking:
    scene bg corridor with dissolve
    window hide

    show gg day 1 neutral at right_pos with dissolve

    show screen down_box("Марк", "#B6544D", "Школа осталась позади вместе со своими готовыми маршрутами и годами выстроенной репутацией.") with dissolve

    $ renpy.pause(999.0)

    hide screen down_box with dissolve

    show screen down_box("Марк", "#B6544D", "Больше ничего нет. Ни истории, ни репутации, ни ярлыка «тихони» или «заучки». Чистый старт. Звук собственных шагов по паркету главного холла отдавался эхом.") with dissolve

    $ renpy.pause(999.0)

    hide screen down_box with dissolve

    hide gg day 1 neutral with dissolve

    show screen center_box350("Коридоры становились уже и запутаннее. \nЗаблудиться в новом месте оказалось проще простого, \nв отличие от уже выученной школьной планировки,\nгде здание имело всем понятную кольцевую форму, \nтут нужно включать голову чтобы добраться из точки А в точку Б") with dissolve

    $ renpy.pause(999.0)

    hide screen center_box350 with dissolve

    show screen center_box250("Лестницы бесконечны, их много и они все ведут в разные места,\nиногда кажется что ты быстрее сойдешь с ума чем найдешь дорогу к заветной кафедре робототехники") with dissolve

    $ renpy.pause(999.0)

    hide screen center_box250 with dissolve

    jump corridor_talking2

label corridor_talking2:
    scene bg corridor2 with dissolve
    window hide

    show gg day 1 calm at left_pos with dissolve

    show screen down_box("Марк", "#B6544D", "Вот он, ключевой навык. Зарабатывать очки. В школе можно было быть серой мышью и все равно получить аттестат. Здесь же твоя оценка на экзамене может на 50% состоять из того, вспомнит ли тебя преподаватель и как он к тебе относится. Нужно строить имидж с нуля. Не тот, что навязала тебе школа, а тот, который будет выгоден.") with dissolve
    
    $ renpy.pause(999.0)

    hide gg day 1 calm with dissolve

    hide screen down_box with dissolve

    show gg day 1 curious at left_pos with dissolve

    show screen down_box("Марк", "#B6544D", "Кем я буду? Упорным трудягой? Гениальным лентяем? Неформальным лидером? Выбор сейчас, в эти первые недели, определит все.") with dissolve

    $ renpy.pause(999.0)

    hide gg day 1 curious with dissolve

    hide screen down_box with dissolve

    show gg day 1 DGAF at left_pos with dissolve

    show screen down_box("Марк", "#B6544D", "Каждая моя улыбка, каждое «здравствуйте» в коридоре, каждый поднятый на семинаре палец — это инвестиция. Инвестиция в симпатию, а значит, в зачеты, в рекомендации, в будущее. Чертов квест на выживание, где вместо меча и щита — дипломатия и самореклама.") with dissolve

    $ renpy.pause(999.0)

    hide gg day 1 DGAF with dissolve

    hide screen down_box with dissolve

    jump room_talking1 

label room_talking1:
    scene bg room 1 with dissolve
    window hide

    show screen center_box250("Когда ты входишь в кабинет, в уши тут же бьет до боли знакомый звук- куча людей оживленно что-то обсуждают, знакомятся, смеются, и все их голоса сливаются в звук, который похож на жужжание сотен пчел.") with dissolve
    $ renpy.pause(999.0)
    hide screen center_box250 with dissolve

    show screen center_box200("Свободных мест уже почти не осталось, последний твой шанс- место рядом с блондинистым парнем у двери") with dissolve
    $ renpy.pause(999.0)
    hide screen center_box200 with dissolve

    show gg day 1 neutral at left_pos with dissolve
    show screen down_box("Марк", "#B6544D", "Выглядит как стереотипный ботаник, должно быть он необщительный… ну, надо надеятся на лучшее") with dissolve
    $ renpy.pause(999.0)
    hide gg day 1 neutral with dissolve
    hide screen down_box with dissolve

    show nerd neutral at right_pos with dissolve
    show screen center_box200("Марк подходит к свободному месту. Лев замечает его движение и чуть отодвигает свой рюкзак, прежде чем тот что-то скажет") with dissolve
    $ renpy.pause(999.0)
    hide nerd neutral with dissolve
    hide screen center_box200 with dissolve

    show gg day 1 questioning at left_pos with dissolve
    show screen down_box("Марк", "#B6544D", "Привет. Можно тут присесть?") with dissolve
    $ renpy.pause(999.0)
    hide gg day 1 questioning with dissolve
    hide screen down_box with dissolve

    show nerd neutral at right_pos with dissolve
    show screen down_box("Лев", "#B99036", "Конечно. Я как раз место грел.") with dissolve
    $ renpy.pause(999.0)
    hide nerd neutral with dissolve
    hide screen down_box with dissolve

    show screen center_box200("Марк садится, ставит рюкзак. Короткая пауза, но уже не такая напряженная.") with dissolve
    $ renpy.pause(999.0)
    hide screen center_box200 with dissolve

    show gg day 1 neutral at left_pos with dissolve
    show screen down_box("Марк", "#B6544D", "Меня зовут Марк.") with dissolve
    $ renpy.pause(999.0)
    hide gg day 1 neutral with dissolve
    hide screen down_box with dissolve

    show nerd neutral at right_pos with dissolve
    show screen down_box("Лев", "#B99036", "Лев. Рад познакомиться!") with dissolve
    $ renpy.pause(999.0)
    hide nerd neutral with dissolve
    hide screen down_box with dissolve

    show nerd happy2 at right_pos with dissolve
    show screen down_box("Лев", "#B99036", "Похоже, мы оба благополучно не заблудились. Уже достижение на первый день.") with dissolve
    $ renpy.pause(999.0)
    hide nerd happy2 with dissolve
    hide screen down_box with dissolve

    show gg day 1 questioning at left_pos with dissolve
    show screen down_box("Марк", "#B6544D", "Да уж. Я уже успел два раза спуститься не в ту лестничную клетку. Думал, опоздаю из-за собственной ориентации в пространстве.") with dissolve
    $ renpy.pause(999.0)
    hide gg day 1 questioning with dissolve
    hide screen down_box with dissolve

    show nerd neutral at right_pos with dissolve
    show screen down_box("Лев", "#B99036", "Здесь это норма. Главное — не пытаться найти логику в нумерации аудиторий. Принимаешь как данность.") with dissolve
    $ renpy.pause(999.0)
    hide nerd neutral with dissolve
    hide screen down_box with dissolve

    show screen center_box300("Дверь в аудиторию распахивается энергичным движением. На пороге — мужчина в голубой рубашке с пестрым галстуком бабочкой, с доброжелательной улыбкой и озорным блеском в глазах. Он уверенно проходит к кафедре, ставя на неё потрёпанный лэптоп.") with dissolve
    $ renpy.pause(999.0)
    hide screen center_box300 with dissolve

    show lestenko neutral at right_pos with dissolve
    show screen down_box("Лестенко", "#909BCE", "Ну что, робототехники, заждались?") with dissolve
    $ renpy.pause(999.0)
    hide screen down_box with dissolve
    show screen center_box250("Его голос легко заполняет комнату, растворяя остатки напряжения. В аудитории наконец воцаряется тишина, но теперь она наполнена не тревогой, а любопытством.")
    $ renpy.pause(999.0)
    hide screen center_box250 with dissolve
    hide lestenko neutral with dissolve

    show nerd happy at right_pos with dissolve
    show screen center_box150("Счастливо кивает в сторону кафедры") with dissolve
    $ renpy.pause(999.0)
    hide screen center_box150 with dissolve
    show screen down_box("Лев", "#B99036", "Ну, поехали.") with dissolve
    $ renpy.pause(999.0)
    hide nerd happy with dissolve
    hide screen down_box with dissolve

    show gg day 1 calm at left_pos with dissolve
    show screen down_box("Марк", "#B6544D", "Поехали.") with dissolve
    $ renpy.pause(999.0)
    hide gg day 1 calm with dissolve
    hide screen down_box with dissolve
    
    show gg day 1 calm at left_pos with dissolve
    show screen down_box("Марк", "#B6544D", "И.. Спасибо!") with dissolve
    $ renpy.pause(999.0)
    hide gg day 1 calm with dissolve
    hide screen down_box with dissolve

    show nerd happy2 at right_pos with dissolve
    show screen down_box("Лев", "#B99036", "Всегда рад помочь потерявшемуся.") with dissolve
    $ renpy.pause(999.0)
    hide nerd happy2 with dissolve
    hide screen down_box with dissolve

    show lestenko neutral at right_pos with dissolve
    show screen down_box("Лестенко", "#909BCE", "Добро пожаловать на робототехнику, будущие инженеры! Меня зовут Никита Александрович, и я буду вашим проводником в мире механизмов, кода и искусственного интеллекта.") with dissolve
    $ renpy.pause(999.0)
    hide lestenko neutral with dissolve
    hide screen down_box with dissolve

    show lestenko happy at right_pos with dissolve
    show screen down_box("Лестенко", "#909BCE", "За следующие несколько лет мы с вами пройдём путь от основ схемотехники и пайки до сложнейших систем компьютерного зрения и нейросетевого управления.") with dissolve
    $ renpy.pause(999.0)
    hide lestenko happy with dissolve
    hide screen down_box with dissolve

    show lestenko neutral at right_pos with dissolve
    show screen down_box("Лестенко", "#909BCE", "Но вся теория — это лишь фундамент. Наша главная цель — практика. Именно поэтому ваш дипломный проект — это не толстенная теоретическая работа, а ваш собственный, уникальный робот, которого вы спроектируете и соберёте своими руками.") with dissolve
    $ renpy.pause(999.0)
    hide screen down_box with dissolve
    show screen down_box("Лестенко", "#909BCE", "Да-да, вы не ослышались. Уже к концу обучения у каждого из вас на столе будет стоять или ездить творение, в которое вы вложите знания, время и, не побоюсь этого слова, душу.") with dissolve
    $ renpy.pause(999.0)
    hide screen down_box with dissolve
    show screen down_box("Лестенко", "#909BCE", "И начинать думать об этом лучше прямо сейчас. Поэтому я не буду вас долго мучать лекцией в первый же день. Следующие полтора часа мы проведём в нашей основной лаборатории — «Кабинете робототехники».") with dissolve
    $ renpy.pause(999.0)
    hide lestenko neutral with dissolve
    hide screen down_box with dissolve

    show lestenko happy at right_pos with dissolve
    show screen down_box("Лестенко", "#909BCE", "Там вы сможете посмотреть на оборудование, на работы старших курсов, и, самое главное, начать набрасывать первые идеи для вашего будущего проекта. Поймёте, что вас больше «зажигает»: мобильные платформы, манипуляторы или, может быть, что-то совсем уникальное.") with dissolve
    $ renpy.pause(999.0)
    hide lestenko happy with dissolve
    hide screen down_box with dissolve

    show lestenko neutral at right_pos with dissolve
    show screen down_box("Лестенко", "#909BCE", "Итак, вопросы есть? Если нет — собираемся и идём знакомиться с местом, где многим из вас предстоит провести бессонные, но, уверяю вас, самые плодотворные ночи!") with dissolve
    $ renpy.pause(999.0)
    hide lestenko neutral with dissolve
    hide screen down_box with dissolve

    jump room_talking2

# --- экран кликабельного объекта (показывает hover и возвращает "clicked") ---
screen robot_item_clickable():
    modal True
    zorder 100

    imagebutton:
        idle "images/objects/robot_items_idle.png"
        hover "images/objects/robot_items_hover.png"
        xpos 550
        ypos -90
        focus_mask True
        action Return("clicked")

label room_talking2:
    scene bg robot_room with dissolve
    window hide

    # показываем неинтерактивный объект именно здесь
    show robot items idle at Position(xpos=1000, ypos=1000)

    show screen center_box350("Лаборатория робототехники напоминает одновременно футуристическую мастерскую и эпицентр творческого хаоса. По стенам выстроились новейшие 3D-принтеры, их столики усыпаны блестящими пластиковыми деталями. Рядом мерцают экраны мощных компьютеров, опутанные проводами паяльных станций…") with dissolve
    $ renpy.pause(999.0)
    hide screen center_box350 with dissolve

    show screen center_box400("Но взгляд цепляется за другое: горы компонентов, сваленных в, казалось бы, беспорядочные кубы. Коробки с датчиками и микросхемами соседствуют с корзинами шестерёнок и сервоприводов. В углу груда алюминиевых профилей и пластиковых панелей напоминает запас стройматериалов, а на столах заросли проводов и плат искрятся медью и припоем. Это место, где инженерная мысль рождается прямо посреди этого плодотворного беспорядка.") with dissolve
    $ renpy.pause(999.0)
    hide screen center_box400 with dissolve

    show lestenko neutral at right_pos with dissolve
    show screen down_box("Лестенко", "#909BCE", "Вот и наше главное сокровище! Не пугайтесь творческого беспорядка — в этих <кучах мусора> скрываются будущие шедевры. Осмотритесь, потрогайте, почувствуйте материалы. Постарайтесь найти то, что отзовётся именно вам — возможно, именно эта шестерёнка или тот датчик станут сердцем вашего проекта.") with dissolve
    $ renpy.pause(999.0)
    hide lestenko neutral with dissolve
    hide screen down_box with dissolve

    show gg day 1 questioning at left_pos with dissolve
    show screen center_box350("В углу, под одним из столов, притаилась настоящая свалка — груда старого оборудования, покрытая слоем пыли, словно многовековой археологический слой. Из-под паутины проглядывают картонные коробки, набитые арматурой и толстыми, похожими на сосуды, проводами. Но взгляд героя не скользит, а цепляется.") with dissolve
    $ renpy.pause(999.0)
    hide screen center_box350 with dissolve
    show screen center_box400("Среди этого хлама, будто волшебный артефакт, стоит старый телевизор-коробка с выпуклым кинескопом. И в этой пыльной поверхности герой видит не старый экран, а лицо. Лицо будущего робота. В его воображении матовое стекло становится выразительным дисплеем, показывающим сложную симуляцию эмоций, а корпус — головой автономного ИИ, мудрого, наблюдательного и... живого. В этой груде металлолома рождается образ.") with dissolve
    $ renpy.pause(999.0)
    hide gg day 1 questioning with dissolve
    hide screen center_box400 with dissolve

    hide robot item idle
    $ rv = renpy.call_screen("robot_item_clickable")
    if rv == "clicked":
        pass
    return



image notebook = "images/objects/notebook.png" 

style booktext:
    size 50
    color"#000000"
style limittext:
    size 25
    color"#000000"

default strq1 = "2 + 2 * 2 = "
default strq2 = "4! + 1 = "
default strq3 = "lim sin(x)/x = "
default strq4 = "lim (3x+1)/x = "
default strq5 = "lim x/ln(x) = "

default int_answer1 = 6
default int_answer2 = 25
default int_answer3 = 1
default int_answer4 = 3
default int_answer5 = 0

image question1 = Text("2+2 * 2 = ", style="booktext")
image question2 = Text("4! + 1 = ", style="booktext")
image question3 = Text("lim sin(x)/x = ", style="booktext")
image question4 = Text("lim (3x+1)/x = ", style="booktext")
image question5 = Text("lim x/ln(x) = ", style="booktext")

image xapproachinginf = Text("x->inf",style="limittext")
image xapproaching0 = Text("x->0",style="limittext")

default correct_answers_list = []
label mathexam:
    $ yposnotebook = -56
    $ sizebetween = 80
    $ yunderlimit = 45
    $ xunderlimit = 10
    $ yshift = 85
    $ yfirst = 230

    show notebook:
        zoom 2.0
        xalign 0.5
        ypos yposnotebook
    
    show question1 as q1:
        xpos 700
        ypos yfirst
    

    show question2 as q2:
        xpos 700
        ypos yfirst + yshift

    show question3 as q3:
        xpos 700
        ypos yfirst + 2*yshift 
    
    show xapproaching0 as abcde:
        xpos 700 + xunderlimit
        ypos yfirst + 2*yshift  + yunderlimit

    show question4 as q4:
        xpos 700
        ypos yfirst + 3*yshift 
    
    show xapproachinginf:
        xpos 700 + xunderlimit
        ypos yfirst + 3*yshift  + yunderlimit

    show question5 as q5:
        xpos 700
        ypos yfirst + 4*yshift 

    show xapproaching0:
        xpos 700 + xunderlimit
        ypos yfirst + 4*yshift + yunderlimit

    $ user_answer1 = renpy.input("Введите ваш результат:",allow="-01234567890",length = 4)
    $ answer_on_question = strq1 + user_answer1
    show image Text("[answer_on_question]",style="booktext") as q1:
        xpos 700
        ypos yfirst
    
    $ correct_answers_list.append(user_answer1.isnumeric() and int(user_answer1) == int_answer1)

    $ user_answer2 = renpy.input("Введите ваш результат:",allow="-01234567890",length = 4)
    $ answer_on_question  = strq2 + user_answer2
    show image Text("[answer_on_question]",style="booktext") as q2:
        xpos 700
        ypos yfirst + yshift 

    $ correct_answers_list.append(user_answer2.isnumeric() and (int(user_answer2) == int_answer2))

    $ user_answer3 = renpy.input("Введите ваш результат:",allow="-01234567890",length = 4)
    $ answer_on_question  = strq3 + user_answer3
    show image Text("[answer_on_question]",style="booktext") as q3:
        xpos 700
        ypos yfirst + 2*yshift 
        
    $ correct_answers_list.append(user_answer3.isnumeric() and (int(user_answer3) == int_answer3))


    $ user_answer4 = renpy.input("Введите ваш результат:",allow="-01234567890",length = 4)
    $ answer_on_question  = strq4 + user_answer4
    show image Text("[answer_on_question]",style="booktext") as q4:
        xpos 700
        ypos yfirst + 3*yshift 
        
    $ correct_answers_list.append(user_answer4.isnumeric() and (int(user_answer4) == int_answer4))

    $ user_answer5 = renpy.input("Введите ваш результат:",allow="-01234567890",length = 4)
    $ answer_on_question  = strq5 + user_answer5
    show image Text("[answer_on_question]",style="booktext") as q5:
        xpos 700
        ypos yfirst + 4*yshift 
        
    $ correct_answers_list.append(user_answer5.isnumeric() and (int(user_answer5) == int_answer5))

    $ correct_answers_count = sum(correct_answers_list)  
    "кхм-кхм дайте посмотреть"

    $ true_answer1 = "".join([strq1 ,"{b}",("{color=#22792B}" if correct_answers_list[0] else "{color=#FF0000}"),user_answer1,"" if correct_answers_list[0] else "{/color}","{/b}"])
    $ true_answer2 = "".join([strq2 ,"{b}",("{color=#22792B}" if correct_answers_list[1] else "{color=#FF0000}"),user_answer2,"" if correct_answers_list[1] else "{/color}","{/b}"])
    $ true_answer3 = "".join([strq3 ,"{b}",("{color=#22792B}" if correct_answers_list[2] else "{color=#FF0000}"),user_answer3,"" if correct_answers_list[2] else "{/color}","{/b}"])
    $ true_answer4 = "".join([strq4 ,"{b}",("{color=#22792B}" if correct_answers_list[3] else "{color=#FF0000}"),user_answer4,"" if correct_answers_list[3] else "{/color}","{/b}"])
    $ true_answer5 = "".join([strq5 ,"{b}",("{color=#22792B}" if correct_answers_list[4] else "{color=#FF0000}"),user_answer5,"" if correct_answers_list[4] else "{/color}","{/b}"])

    show image Text("[true_answer1]",style="booktext") as q1:
        xpos 700
        ypos yfirst 
    show image Text("[true_answer2]",style="booktext") as q2:
        xpos 700
        ypos yfirst + yshift
    show image Text("[true_answer3]",style="booktext") as q3:
        xpos 700
        ypos yfirst + 2*yshift  
    show image Text("[true_answer4]",style="booktext") as q4:
        xpos 700
        ypos yfirst + 3*yshift  
    show image Text("[true_answer5]",style="booktext") as q5:
        xpos 700
        ypos yfirst + 4*yshift  
        
    "количество правильных ответов: [correct_answers_count]"
    "это тебе не отчёты писать"
    " "
    return

default beginpow = "{size=-10}"
default endpow = "{/size}"

default str2q1 = "1/2 + 1/3 + 1/6 = "
default str2q2 = "10!/8! = "
default str2q3 = "lim(x*x)/(1-cosx)= "
default str2q4 = "x^{size=-10}2{/size} -6x+9=0   x= "
default str2q5 = "lim sin5x/ln(x+1)= "

default int2_answer1 = 1
default int2_answer2 = 90
default int2_answer3 = 2
default int2_answer4 = 3
default int2_answer5 = 5

image question21 = Text("1/2 + 1/3 + 1/6 = ", style="booktext")
image question22 = Text("10!/8! = ", style="booktext")
image question23 = Text("lim(x*x)/(1-cosx)= ", style="booktext")
image question24 = Text("x^{size=-10}2{/size} -6x+9=0   x= ", style="booktext")
image question25 = Text("lim sin5x/ln(x+1)= ", style="booktext")

default correct_answers_list2 = []

label mathexam2:
    $ yposnotebook = -56
    $ sizebetween = 80
    $ yunderlimit = 45
    $ xunderlimit = 10
    $ yshift = 85
    $ yfirst = 230

    show notebook:
        zoom 2.0
        xalign 0.5
        ypos yposnotebook
    
    show question21 as q1:
        xpos 700
        ypos yfirst
    

    show question22 as q2:
        xpos 700
        ypos yfirst + yshift

    show question23 as q3:
        xpos 700
        ypos yfirst + 2*yshift 
    
    show xapproaching0 as abcd:
        xpos 700 + xunderlimit
        ypos yfirst + 2*yshift  + yunderlimit

    show question24 as q4:
        xpos 700
        ypos yfirst + 3*yshift 
    

    show question25 as q5:
        xpos 700
        ypos yfirst + 4*yshift 

    show xapproaching0:
        xpos 700 + xunderlimit
        ypos yfirst + 4*yshift + yunderlimit

    $ user_answer1 = renpy.input("Введите ваш результат:",allow="-01234567890",length = 4)
    $ answer_on_question = str2q1 + user_answer1
    show image Text("[answer_on_question]",style="booktext") as q1:
        xpos 700
        ypos yfirst
    
    $ correct_answers_list2.append(user_answer1.isnumeric() and int(user_answer1) == int2_answer1)

    $ user_answer2 = renpy.input("Введите ваш результат:",allow="-01234567890",length = 4)
    $ answer_on_question  = str2q2 + user_answer2
    show image Text("[answer_on_question]",style="booktext") as q2:
        xpos 700
        ypos yfirst + yshift 

    $ correct_answers_list2.append(user_answer2.isnumeric() and (int(user_answer2) == int2_answer2))

    $ user_answer3 = renpy.input("Введите ваш результат:",allow="-01234567890",length = 4)
    $ answer_on_question  = str2q3 + user_answer3
    show image Text("[answer_on_question]",style="booktext") as q3:
        xpos 700
        ypos yfirst + 2*yshift 
    
    show xapproaching0:
        xpos 700 + xunderlimit
        ypos yfirst + 2*yshift + yunderlimit

    $ correct_answers_list2.append(user_answer3.isnumeric() and (int(user_answer3) == int2_answer3))


    $ user_answer4 = renpy.input("Введите ваш результат:",allow="-01234567890",length = 4)
    $ answer_on_question  = str2q4 + user_answer4
    show image Text("[answer_on_question]",style="booktext") as q4:
        xpos 700
        ypos yfirst + 3*yshift 
        
    $ correct_answers_list2.append(user_answer4.isnumeric() and (int(user_answer4) == int2_answer4))

    $ user_answer5 = renpy.input("Введите ваш результат:",allow="-01234567890",length = 4)
    $ answer_on_question  = str2q5 + user_answer5
    show image Text("[answer_on_question]",style="booktext") as q5:
        xpos 700
        ypos yfirst + 4*yshift 
        
    $ correct_answers_list2.append(user_answer5.isnumeric() and (int(user_answer5) == int2_answer5))

    $ correct_answers_count2 = sum(correct_answers_list2)  
    "кхм-кхм дайте посмотреть"

    $ true_answer1 = "".join([str2q1 ,"{b}",("{color=#22792B}" if correct_answers_list2[0] else "{color=#FF0000}"),user_answer1,"" if correct_answers_list2[0] else "{/color}","{/b}"])
    $ true_answer2 = "".join([str2q2 ,"{b}",("{color=#22792B}" if correct_answers_list2[1] else "{color=#FF0000}"),user_answer2,"" if correct_answers_list2[1] else "{/color}","{/b}"])
    $ true_answer3 = "".join([str2q3 ,"{b}",("{color=#22792B}" if correct_answers_list2[2] else "{color=#FF0000}"),user_answer3,"" if correct_answers_list2[2] else "{/color}","{/b}"])
    $ true_answer4 = "".join([str2q4 ,"{b}",("{color=#22792B}" if correct_answers_list2[3] else "{color=#FF0000}"),user_answer4,"" if correct_answers_list2[3] else "{/color}","{/b}"])
    $ true_answer5 = "".join([str2q5 ,"{b}",("{color=#22792B}" if correct_answers_list2[4] else "{color=#FF0000}"),user_answer5,"" if correct_answers_list2[4] else "{/color}","{/b}"])

    show image Text("[true_answer1]",style="booktext") as q1:
        xpos 700
        ypos yfirst 
    show image Text("[true_answer2]",style="booktext") as q2:
        xpos 700
        ypos yfirst + yshift
    show image Text("[true_answer3]",style="booktext") as q3:
        xpos 700
        ypos yfirst + 2*yshift  
    show image Text("[true_answer4]",style="booktext") as q4:
        xpos 700
        ypos yfirst + 3*yshift  
    show image Text("[true_answer5]",style="booktext") as q5:
        xpos 700
        ypos yfirst + 4*yshift  
        
    "количество правильных ответов: [correct_answers_count2]"
    return


init:
    $ timer_range = 0
    $ timer_jump = 0

image clock = "images/objects/clock.png" 

transform alpha_dissolve:
    alpha 0.0
    linear 0.5 alpha 1.0
    on hide:
        linear 0.5 alpha 0
    # This is to fade the bar in and out, and is only required once in your script



screen my_bar_screen():
    frame:
        xalign 0.5
        yalign 0.1
        bar value VariableValue("my_value", 100) style "my_bar_style"

screen countdown:
    timer 0.01 repeat True action If(time > 0, true=SetVariable('time', time - 0.01), false=[Hide('countdown'), Jump(timer_jump)])
    bar value time range timer_range xalign 0.11 yalign 0.70 xysize (100,350) bar_vertical True at alpha_dissolve # This is the timer bar.

#xalign 0.1225 yalign 0.65
define gui.choice_button_text_idle_color = "#ffffff"
define gui.choice_button_text_hover_color = "#000000"

label capybaragame:
    scene bg capybara with dissolve
    $ time = 12
    $ timer_range = 10
    $ timer_jump = 'capybaraincorrect'
    $ color = ""
    #hide screen countdown
    show screen countdown zorder 0

    show clock zorder 1:
        xalign 0.0
        yalign 0.0

  
    menu:
        "Что такое массив в C?"

        "Это коллекция переменных разного типа":
            jump capybaraincorrect

        "Это указатель на первую ячейку памяти":
            jump capybaraincorrect

        "Это совокупность элементов одного типа, расположенных в памяти последовательно":
            $ timer_range = 11
            $ time = min(timer_range,time + 5) 



    menu:
        "Какая функция используется в C для выделения динамической памяти?"

        "malloc()":
            $ timer_range = 10
            $ time = min(timer_range,time + 5) 
            
        "new()":
            jump capybaraincorrect
        
        "allocate()":
            jump capybaraincorrect

        "create()":
            jump capybaraincorrect


    menu:
        "Что происходит при выполнении операции инкремента указателя ptr++ в C?"

        "Значение указателя увеличивается ровно на 1 байт":
            jump capybaraincorrect
        "Значение указателя увеличивается на размер типа, на который он указывает":
            $ timer_range = 11
            $ time = min(timer_range,time + 7) 
        "Происходит инкремент значения в ячейке памяти, на которую указывает ptr":
            jump capybaraincorrect
        "Указатель начинает указывать на случайную область памяти":
            jump capybaraincorrect

    hide screen countdown
    "ты ответил на все вопросы"


label capybaraincorrect:
    "пошёл отсюда"

