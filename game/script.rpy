# Фон — фотография
image bg street = "images/bg/street.jpg"
image bg room 1 = "images/bg/room1.jpg"
image bg room 2 = "images/bg/room2.jpg"
image bg room 3 = "images/bg/room3.jpg"
image bg room 4 = "images/bg/room4.jpg"
image bg corridor = "images/bg/corridor.jpg"
image bg corridor2 = "images/bg/corridor2.jpg"
image bg window_macbook = "images/bg/window_macbook.jpg"

# Спрайты
image gg day 1 neutral = At("images/characters/gg_day1/nuetral.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 scared = At("images/characters/gg_day1/scared.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 questioning = At("images/characters/gg_day1/questioning.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 happy2 = At("images/characters/gg_day1/happy2.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 happy = At("images/characters/gg_day1/happy.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 furious = At("images/characters/gg_day1/furious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 DGAF = At("images/characters/gg_day1/DGAF.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 curious = At("images/characters/gg_day1/curious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 calm = At("images/characters/gg_day1/calm.png", Transform(zoom=1.3, xzoom=-1))
image gg day 1 angry = At("images/characters/gg_day1/angry.png", Transform(zoom=1.3, xzoom=-1))

image nerd neutral = At("images/characters/nerd/neutral.png", Transform(zoom=1.3))
image nerd angry = At("images/characters/nerd/angry.png", Transform(zoom=1.3))
image nerd calm = At("images/characters/nerd/calm.png", Transform(zoom=1.3))
image nerd curious = At("images/characters/nerd/curious.png", Transform(zoom=1.3))
image nerd DGAF = At("images/characters/nerd/DGAF.png", Transform(zoom=1.3))
image nerd furious = At("images/characters/nerd/furious.png", Transform(zoom=1.3))
image nerd happy = At("images/characters/nerd/happy.png", Transform(zoom=1.3))
image nerd happy2 = At("images/characters/nerd/happy2.png", Transform(zoom=1.3))
image nerd questioning = At("images/characters/nerd/questioning.png", Transform(zoom=1.3))
image nerd scared = At("images/characters/nerd/scared.png", Transform(zoom=1.3))

image wallstein angry = At("images/characters/wallstein/angry.png", Transform(zoom=1.3))
image wallstein happy = At("images/characters/wallstein/happy.png", Transform(zoom=1.3))
image wallstein neutral = At("images/characters/wallstein/neutral.png", Transform(zoom=1.3))
image wallstein questioning = At("images/characters/wallstein/questioning.png", Transform(zoom=1.3))
image wallstein thinking = At("images/characters/wallstein/thinking.png", Transform(zoom=1.3))

image lestenko angry = At("images/characters/lestenko/angry.png", Transform(zoom=1.3))
image lestenko neutral = At("images/characters/lestenko/neutral.png", Transform(zoom=1.3))
image lestenko happy = At("images/characters/lestenko/happy.png", Transform(zoom=1.3))
image lestenko questioning = At("images/characters/lestenko/questioning.png", Transform(zoom=1.3))
image lestenko notUnderstanding = At("images/characters/lestenko/notUnderstanding.png", Transform(zoom=1.3))

image rakova angry = At("images/characters/rakova/angry.png", Transform(zoom=1.3))
image rakova happy = At("images/characters/rakova/happy.png", Transform(zoom=1.3))
image rakova thinking = At("images/characters/rakova/thinking.png", Transform(zoom=1.3))
image rakova neutral = At("images/characters/rakova/neutral.png", Transform(zoom=1.3))
image rakova questioning = At("images/characters/rakova/questioning.png", Transform(zoom=1.3))

image tarasov angry = At("images/characters/tarasov/angry.png", Transform(zoom=1.3))
image tarasov happy = At("images/characters/tarasov/happy.png", Transform(zoom=1.3))
image tarasov thinking = At("images/characters/tarasov/thinking.png", Transform(zoom=1.3))
image tarasov neutral = At("images/characters/tarasov/neutral.png", Transform(zoom=1.3))
image tarasov questioning = At("images/characters/tarasov/questioning.png", Transform(zoom=1.3))

image semyonova angry = At("images/characters/semyonova/angry.png", Transform(zoom=1.3))
image semyonova happy = At("images/characters/semyonova/happy.png", Transform(zoom=1.3))
image semyonova thinking = At("images/characters/semyonova/thinking.png", Transform(zoom=1.3))
image semyonova neutral = At("images/characters/semyonova/neutral.png", Transform(zoom=1.3))
image semyonova questioning = At("images/characters/semyonova/questioning.png", Transform(zoom=1.3))

image zharova angry = At("images/characters/zharova/angry.png", Transform(zoom=1.3))
image zharova happy = At("images/characters/zharova/happy.png", Transform(zoom=1.3))
image zharova thinking = At("images/characters/zharova/thinking.png", Transform(zoom=1.3))
image zharova neutral = At("images/characters/zharova/neutral.png", Transform(zoom=1.3))
image zharova questioning = At("images/characters/zharova/questioning.png", Transform(zoom=1.3))

image naurusova angry = At("images/characters/naurusova/angry.png", Transform(zoom=1.3))
image naurusova happy = At("images/characters/naurusova/happy.png", Transform(zoom=1.3))
image naurusova thinking = At("images/characters/naurusova/thinking.png", Transform(zoom=1.3))
image naurusova neutral = At("images/characters/naurusova/neutral.png", Transform(zoom=1.3))
image naurusova questioning = At("images/characters/naurusova/questioning.png", Transform(zoom=1.3))

image scherbakova angry = At("images/characters/scherbakova/angry.png", Transform(zoom=1.3))
image scherbakova happy = At("images/characters/scherbakova/happy.png", Transform(zoom=1.3))
image scherbakova thinking = At("images/characters/scherbakova/thinking.png", Transform(zoom=1.3))
image scherbakova neutral = At("images/characters/scherbakova/neutral.png", Transform(zoom=1.3))
image scherbakova questioning = At("images/characters/scherbakova/questioning.png", Transform(zoom=1.3))

image logunova angry = At("images/characters/logunova/angry.png", Transform(zoom=1.3))
image logunova happy = At("images/characters/logunova/happy.png", Transform(zoom=1.3))
image logunova thinking = At("images/characters/logunova/thinking.png", Transform(zoom=1.3))
image logunova neutral = At("images/characters/logunova/neutral.png", Transform(zoom=1.3))
image logunova questioning = At("images/characters/logunova/questioning.png", Transform(zoom=1.3))

image bully neutral = At("images/characters/bully/nuetral.png", Transform(zoom=1.3))
image bully scared = At("images/characters/bully/scared.png", Transform(zoom=1.3))
image bully questioning = At("images/characters/bully/questioning.png", Transform(zoom=1.3))
image bully questioning2 = At("images/characters/bully/questioning2.png", Transform(zoom=1.3))
image bully happy = At("images/characters/bully/happy.png", Transform(zoom=1.3))
image bully happy2 = At("images/characters/bully/happy2.png", Transform(zoom=1.3))
image bully furious = At("images/characters/bully/furious.png", Transform(zoom=1.3))
image bully curious = At("images/characters/bully/curious.png", Transform(zoom=1.3))
image bully angry = At("images/characters/bully/angry.png", Transform(zoom=1.3))
image bully talking = At("images/characters/bully/talking.png", Transform(zoom=1.3))

image gg day 2 angry = At("images/characters/gg_day2/angry.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 calm = At("images/characters/gg_day2/calm.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 curious = At("images/characters/gg_day2/curious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 furious = At("images/characters/gg_day2/furious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 happy = At("images/characters/gg_day2/happy.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 happy2 = At("images/characters/gg_day2/happy2.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 happy3 = At("images/characters/gg_day2/happy3.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 neutral = At("images/characters/gg_day2/neutral.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 questioning = At("images/characters/gg_day2/questioning.png", Transform(zoom=1.3, xzoom=-1))
image gg day 2 questioning2 = At("images/characters/gg_day2/questioning2.png", Transform(zoom=1.3, xzoom=-1))

image gg day 3 angry = At("images/characters/gg_day3/angry.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 calm = At("images/characters/gg_day3/calm.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 curious = At("images/characters/gg_day3/curious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 DGAF = At("images/characters/gg_day3/DGAF.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 furious = At("images/characters/gg_day3/furious.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 happy = At("images/characters/gg_day3/happy.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 happy2 = At("images/characters/gg_day3/happy2.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 neutral = At("images/characters/gg_day3/neutral.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 questioning = At("images/characters/gg_day3/questioning.png", Transform(zoom=1.3, xzoom=-1))
image gg day 3 scared = At("images/characters/gg_day3/scared.png", Transform(zoom=1.3, xzoom=-1))

image altushka angry = At("images/characters/altushka/angry.png", Transform(zoom=1.3))
image altushka blush = At("images/characters/altushka/blush.png", Transform(zoom=1.3))
image altushka curious = At("images/characters/altushka/curious.png", Transform(zoom=1.3))
image altushka DGAF = At("images/characters/altushka/DGAF.png", Transform(zoom=1.3))
image altushka DGAF2 = At("images/characters/altushka/DGAF2.png", Transform(zoom=1.3))
image altushka furious = At("images/characters/altushka/furious.png", Transform(zoom=1.3))
image altushka happy = At("images/characters/altushka/happy.png", Transform(zoom=1.3))
image altushka happy2 = At("images/characters/altushka/happy2.png", Transform(zoom=1.3))
image altushka irritated = At("images/characters/altushka/irritated.png", Transform(zoom=1.3))
image altushka neutral = At("images/characters/altushka/neutral.png", Transform(zoom=1.3))
image altushka scared = At("images/characters/altushka/scared.png", Transform(zoom=1.3))

image robot angry = At("images/characters/robot/angry.png", Transform(zoom=1.3))
image robot full_ready = At("images/characters/robot/full_ready.png", Transform(zoom=1.3))
image robot items = At("images/characters/robot/items.png", Transform(zoom=1.3))
image robot pre_ready = At("images/characters/robot/pre_ready.png", Transform(zoom=1.3))
image robot prototype = At("images/characters/robot/prototype.png", Transform(zoom=1.3))
image robot working = At("images/characters/robot/working.png", Transform(zoom=1.3))

image matveev angry = At("images/characters/matveev/angry.png", Transform(zoom=1.3))
image matveev happy = At("images/characters/matveev/happy.png", Transform(zoom=1.3))
image matveev thinking = At("images/characters/matveev/thinking.png", Transform(zoom=1.3))
image matveev neutral = At("images/characters/matveev/neutral.png", Transform(zoom=1.3))
image matveev questioning = At("images/characters/matveev/questioning.png", Transform(zoom=1.3))

image kurochkin angry = At("images/characters/kurochkin/angry.png", Transform(zoom=1.3))
image kurochkin happy = At("images/characters/kurochkin/happy.png", Transform(zoom=1.3))
image kurochkin thinking = At("images/characters/kurochkin/thinking.png", Transform(zoom=1.3))
image kurochkin neutral = At("images/characters/kurochkin/neutral.png", Transform(zoom=1.3))
image kurochkin questioning = At("images/characters/kurochkin/questioning.png", Transform(zoom=1.3))
 
# Позиции
define left_pos = Position(xalign=-0.1, ypos=1.4)
define right_pos = Position(xalign=1.1, ypos=1.4)

# Стиль для текста диалога
style say_dialogue:
    color "#FFFFFF"
    size 50
    text_align 0  # Выравнивание по центру
    xalign 0      # По центру по горизонтали
    xpos 0.19
    yalign 0.5

# Стиль для имени персонажа
style say_label:
    color "#FFFFFF"
    size 50
    bold True

# ============================
#   РЕГИСТРАЦИЯ ПЕРСОНАЖЕЙ
# ============================

init python:
    # Словарь: кодовое имя → отображаемое имя
    CHARACTER_NAMES = {
        "gg_day1": "Герой",
        "gg_day2": "Герой",
        "gg_day3": "Герой",
        "nerd": "Ботаник",
        "bully": "Хулиган",
        "altushka": "Алтушка",
        "robot": "Робот",
        "wallstein": "Вальдштейн",
        "lestenko": "Лестенко",
        "rakova": "Ракова",
        "tarasov": "Тарасов",
        "semyonova": "Семёнова",
        "zharova": "Жарова",
        "naurusova": "Наурусова",
        "scherbakova": "Щербакова",
        "logunova": "Логунова",
        "matveev": "Матвеев",
        "kurochkin": "Курочкин",
    }

# Автоматически создаём объекты Ren'Py Character
init python:
    for code, name in CHARACTER_NAMES.items():
        renpy.store.__dict__[code] = Character(name)

# ============================
#   СИСТЕМА ЭМОЦИЙ
# ============================

init python:
    def _show_emote(prefix, emote, pos):
        img = f"{prefix} {emote}"

        if pos == "left":
            at_list = [left_pos]
        elif pos == "right":
            at_list = [right_pos]
        else:
            at_list = []

        renpy.show(img, at_list=at_list)

# Делаем ренпай-команды вида:
#     show_gg happy left
#     show_nerd angry right


init python:

    def make_show(prefix):
        def func(emote, pos="center"):
            _show_emote(prefix, emote, pos)
        return func

# Герой по дням
init python:
    show_gg = make_show("gg day 1")
    show_gg2 = make_show("gg day 2")
    show_gg3 = make_show("gg day 3")

# Остальные
init python:
    show_nerd = make_show("nerd")
    show_bully = make_show("bully")
    show_altushka = make_show("altushka")
    show_robot = make_show("robot")
    show_wallstein = make_show("wallstein")
    show_lestenko = make_show("lestenko")
    show_rakova = make_show("rakova")
    show_tarasov = make_show("tarasov")
    show_semyonova = make_show("semyonova")
    show_zharova = make_show("zharova")
    show_naurusova = make_show("naurusova")
    show_scherbakova = make_show("scherbakova")
    show_logunova = make_show("logunova")
    show_matveev = make_show("matveev")
    show_kurochkin = make_show("kurochkin")

transform fade_box:
    alpha 0.0
    linear 0.5 alpha 1.0  # плавное появление

transform fade_box_out:
    linear 0.5 alpha 0.0


label start:
    # Проигрываем видео 47 секунд
    play movie "images/video/intro.webm"
    # $ renpy.pause(47.0, hard=False)
    stop movie fadeout 1.0
    jump street

screen center_box250(t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1850
        ysize 250

        xalign 0.5
        yalign 0.5

        padding (40, 40)

        text t slow_cps 30:
            size 48
            color "#FFFFFF"
            text_align 0.5
            xalign 0.5

screen center_box350(t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1850
        ysize 350

        xalign 0.5
        yalign 0.5

        padding (40, 40)

        text t slow_cps 30:
            size 44
            color "#FFFFFF"
            text_align 0.5
            xalign 0.5

screen center_box400(t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1850
        ysize 400

        xalign 0.5
        yalign 0.5

        padding (40, 40)

        text t slow_cps 30:
            size 44
            color "#FFFFFF"
            text_align 0.5
            xalign 0.5

screen center_box300(t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1850
        ysize 300

        xalign 0.5
        yalign 0.5

        padding (40, 40)

        text t slow_cps 30:
            size 44
            color "#FFFFFF"
            text_align 0.5
            xalign 0.5

screen down_box(character_name=None, t=""):
    frame:
        at fade_box
        background Frame("gui/textbox.png", 0, 0)
        xsize 1500
        ysize 300

        xalign 0.5
        ypos 1050  # чуть выше низа экрана, можно подправить
        yanchor 1.0

        padding (40, 40)

        vbox:
            spacing 10

            # Имя персонажа
            if character_name:
                text character_name:
                    size 40
                    color "#bc8545"  # золотой цвет, можно поменять
                    bold True
                    xalign 0.0  # слева внутри фрейма

            # Основной текст
            text t slow_cps 15:
                size 30
                color "#FFFFFF"
                text_align 0.0
                xalign 0.0

label street:
    scene bg street with dissolve
    window hide

    show screen center_box250("Солнечный свет золотит тонкие пруты железного забора.\nДля кого-то это пространство между воротами и корпусом — просто\nдорога, но для него — портал в новую жизнь.") with dissolve

    $ renpy.pause(999.0)

    hide screen center_box250 with dissolve

    jump corridor_talking

label corridor_talking:
    scene bg corridor with dissolve
    window hide

    show gg day 1 neutral at right_pos with dissolve

    show screen down_box("Герой", "Школа осталась позади вместе со своими готовыми маршрутами и годами выстроенной репутацией.") with dissolve

    $ renpy.pause(999.0)

    hide screen down_box with dissolve

    show screen down_box("Герой", "Больше ничего нет. Ни истории, ни репутации, ни ярлыка «тихони» или «заучки». Чистый старт. Звук собственных шагов по паркету главного холла отдавался эхом.") with dissolve

    $ renpy.pause(999.0)

    hide screen down_box with dissolve

    hide gg day 1 neutral with dissolve

    show screen center_box350("Коридоры становились уже и запутаннее. \nЗаблудиться в новом месте оказалось проще простого, \nв отличие от уже выученной школьной планировки,\nгде здание имело всем понятную кольцевую форму, \nтут нужно включать голову чтобы добраться из точки А в точку Б") with dissolve

    $ renpy.pause(999.0)

    hide screen center_box350 with dissolve

    show screen center_box250("Лестницы бесконечны, их много и они все ведут в разные места,\nиногда кажется что ты быстрее сойдешь с ума чем найдешь дорогу к заветной кафедре робототехники") with dissolve

    $ renpy.pause(999.0)

    hide screen center_box250 with dissolve

    jump corridor_talking2

label corridor_talking2:
    scene bg corridor2 with dissolve
    window hide

    show gg day 1 calm at left_pos with dissolve

    show screen down_box("Герой", "Вот он, ключевой навык. Зарабатывать очки. В школе можно было быть серой мышью и все равно получить аттестат. Здесь же твоя оценка на экзамене может на 50% состоять из того, вспомнит ли тебя преподаватель и как он к тебе относится. Нужно строить имидж с нуля. Не тот, что навязала тебе школа, а тот, который будет выгоден.") with dissolve
    
    $ renpy.pause(999.0)

    hide gg day 1 calm with dissolve

    hide screen down_box with dissolve

    show gg day 1 curious at left_pos with dissolve

    show screen down_box("Герой", "Кем я буду? Упорным трудягой? Гениальным лентяем? Неформальным лидером? Выбор сейчас, в эти первые недели, определит все.") with dissolve

    $ renpy.pause(999.0)

    hide gg day 1 curious with dissolve

    hide screen down_box with dissolve

    show gg day 1 DGAF at left_pos with dissolve

    show screen down_box("Герой", "Каждая моя улыбка, каждое «здравствуйте» в коридоре, каждый поднятый на семинаре палец — это инвестиция. Инвестиция в симпатию, а значит, в зачеты, в рекомендации, в будущее. Чертов квест на выживание, где вместо меча и щита — дипломатия и самореклама.") with dissolve

    $ renpy.pause(999.0)

    hide gg day 1 DGAF with dissolve

    hide screen down_box with dissolve

    return 